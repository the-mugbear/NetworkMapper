backend-1   | 2025-09-24T20:21:04.769303813Z 2025-09-24 20:21:04,769 - app.services.nessus_integration_service - INFO - Processed 24 vulnerabilities for host 10.12.17.199
backend-1   | 2025-09-24T20:21:04.830174300Z 2025-09-24 20:21:04,830 - app.services.nessus_integration_service - INFO - Processed 24 vulnerabilities for host 10.12.17.198
backend-1   | 2025-09-24T20:21:04.890267509Z 2025-09-24 20:21:04,890 - app.services.nessus_integration_service - INFO - Processed 24 vulnerabilities for host 10.12.17.197
backend-1   | 2025-09-24T20:21:04.923971521Z 2025-09-24 20:21:04,923 - app.services.nessus_integration_service - INFO - Processed 14 vulnerabilities for host 10.12.17.133
backend-1   | 2025-09-24T20:21:04.996800071Z 2025-09-24 20:21:04,996 - app.services.nessus_integration_service - INFO - Processed 30 vulnerabilities for host 10.12.16.5
backend-1   | 2025-09-24T20:21:05.008688088Z 2025-09-24 20:21:05,006 - app.services.ingestion_service - ERROR - Failed ingestion job 1
backend-1   | 2025-09-24T20:21:05.008707177Z Traceback (most recent call last):
backend-1   | 2025-09-24T20:21:05.008709626Z   File "/app/app/services/ingestion_service.py", line 270, in _process_job
backend-1   | 2025-09-24T20:21:05.008711732Z     job.id,
backend-1   | 2025-09-24T20:21:05.008713405Z     ^^^^^^
backend-1   | 2025-09-24T20:21:05.008715114Z   File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 569, in __get__
backend-1   | 2025-09-24T20:21:05.008717040Z     return self.impl.get(state, dict_)  # type: ignore[no-any-return]
backend-1   | 2025-09-24T20:21:05.008718860Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1   | 2025-09-24T20:21:05.008720656Z   File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1096, in get
backend-1   | 2025-09-24T20:21:05.008722587Z     value = self._fire_loader_callables(state, key, passive)
backend-1   | 2025-09-24T20:21:05.008724227Z             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1   | 2025-09-24T20:21:05.008726031Z   File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1126, in _fire_loader_callables
backend-1   | 2025-09-24T20:21:05.008741543Z     return state._load_expired(state, passive)
backend-1   | 2025-09-24T20:21:05.008743380Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1   | 2025-09-24T20:21:05.008745151Z   File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 803, in _load_expired
backend-1   | 2025-09-24T20:21:05.008747004Z     self.manager.expired_attribute_loader(self, toload, passive)
backend-1   | 2025-09-24T20:21:05.008748691Z   File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 1607, in load_scalar_attributes
backend-1   | 2025-09-24T20:21:05.008750506Z     raise orm_exc.DetachedInstanceError(
backend-1   | 2025-09-24T20:21:05.008752290Z sqlalchemy.orm.exc.DetachedInstanceError: Instance <IngestionJob at 0x7f0066bd9a90> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
backend-1   | 2025-09-24T20:21:05.008754759Z 
backend-1   | 2025-09-24T20:21:05.008756382Z During handling of the above exception, another exception occurred:
backend-1   | 2025-09-24T20:21:05.008758107Z 
backend-1   | 2025-09-24T20:21:05.008759739Z Traceback (most recent call last):
backend-1   | 2025-09-24T20:21:05.008761341Z   File "/app/app/services/ingestion_service.py", line 192, in _run_job
backend-1   | 2025-09-24T20:21:05.008763079Z     result = self._process_job(db, job)
backend-1   | 2025-09-24T20:21:05.008764703Z              ^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1   | 2025-09-24T20:21:05.008766387Z   File "/app/app/services/ingestion_service.py", line 280, in _process_job
backend-1   | 2025-09-24T20:21:05.008768264Z     job.id,
backend-1   | 2025-09-24T20:21:05.008769858Z     ^^^^^^
backend-1   | 2025-09-24T20:21:05.008771482Z   File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 569, in __get__
backend-1   | 2025-09-24T20:21:05.008773387Z     return self.impl.get(state, dict_)  # type: ignore[no-any-return]
backend-1   | 2025-09-24T20:21:05.008775079Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1   | 2025-09-24T20:21:05.008780660Z   File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1096, in get
backend-1   | 2025-09-24T20:21:05.008782615Z     value = self._fire_loader_callables(state, key, passive)
backend-1   | 2025-09-24T20:21:05.008784377Z             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1   | 2025-09-24T20:21:05.008786096Z   File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1126, in _fire_loader_callables
backend-1   | 2025-09-24T20:21:05.008788138Z     return state._load_expired(state, passive)
backend-1   | 2025-09-24T20:21:05.008789797Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend-1   | 2025-09-24T20:21:05.008791547Z   File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 803, in _load_expired
backend-1   | 2025-09-24T20:21:05.008793391Z     self.manager.expired_attribute_loader(self, toload, passive)
backend-1   | 2025-09-24T20:21:05.008795160Z   File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 1607, in load_scalar_attributes
backend-1   | 2025-09-24T20:21:05.008796981Z     raise orm_exc.DetachedInstanceError(
backend-1   | 2025-09-24T20:21:05.008801610Z sqlalchemy.orm.exc.DetachedInstanceError: Instance <IngestionJob at 0x7f0066bd9a90> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
backend-1   | 2025-09-24T20:21:07.956480866Z INFO:     192.168.80.4:38386 - "GET /api/v1/upload/jobs/1 HTTP/1.1" 200 OK
backend-1   | 2025-09-24T20:21:14.295957395Z INFO:     127.0.0.1:52260 - "GET /health HTTP/1.1" 200 OK
backend-1   | 2025-09-24T20:21:44.393712360Z INFO:     127.0.0.1:42582 - "GET /health HTTP/1.1" 200 OK
backend-1   | 2025-09-24T20:22:14.459858096Z INFO:     127.0.0.1:50884 - "GET /health HTTP/1.1" 200 OK
backend-1   | 2025-09-24T20:22:44.530077925Z INFO:     127.0.0.1:43874 - "GET /health HTTP/1.1" 200 OK
backend-1   | 2025-09-24T20:22:45.335637927Z INFO:     192.168.80.4:42904 - "GET /api/v1/scans/?skip=0&limit=100 HTTP/1.1" 200 OK
backend-1   | 2025-09-24T20:23:02.439259304Z 2025-09-24 20:23:02,439 - app.services.ingestion_service - INFO - Queued ingestion job 2 for Solstice - Basic Network Scan_7979q7.nessus (397642558 bytes)
backend-1   | 2025-09-24T20:23:02.455869002Z INFO:     192.168.80.4:45068 - "GET /api/v1/hosts/filters/data HTTP/1.1" 200 OK
backend-1   | 2025-09-24T20:23:02.458265274Z INFO:     192.168.80.4:45080 - "GET /api/v1/hosts/filters/data HTTP/1.1" 200 OK
backend-1   | 2025-09-24T20:23:02.471512644Z INFO:     192.168.80.4:45056 - "POST /api/v1/upload/ HTTP/1.1" 200 OK
backend-1   | 2025-09-24T20:23:02.473205433Z 2025-09-24 20:23:02,473 - app.services.ingestion_service - INFO - Job 2: attempting parser NessusIntegrationService for Solstice - Basic Network Scan_7979q7.nessus
backend-1   | 2025-09-24T20:23:02.585166779Z 2025-09-24 20:23:02,584 - app.services.nessus_integration_service - INFO - Processed 19 vulnerabilities for host 199.64.220.249
backend-1   | 2025-09-24T20:23:02.652005543Z INFO:     192.168.80.4:45084 - "GET /api/v1/hosts/ HTTP/1.1" 200 OK
backend-1   | 2025-09-24T20:23:02.667451331Z 2025-09-24 20:23:02,667 - app.services.nessus_integration_service - INFO - Processed 19 vulnerabilities for host 199.64.220.241
backend-1   | 2025-09-24T20:23:02.784268911Z 2025-09-24 20:23:02,784 - app.services.nessus_integration_service - INFO - Processed 73 vulnerabilities for host 199.64.220.133
backend-1   | 2025-09-24T20:23:02.893019142Z 2025-09-24 20:23:02,892 - app.services.nessus_integration_service - INFO - Processed 72 vulnerabilities for host 199.64.220.132
backend-1   | 2025-09-24T20:23:03.014714936Z 2025-09-24 20:23:03,012 - app.services.nessus_integration_service - INFO - Processed 70 vulnerabilities for host 199.64.220.131



2025-09-24 20:29:21,753 - app.services.nessus_integration_service - INFO - Processed 15 vulnerabilities for host 10.12.17.1
2025-09-24 20:29:21,830 - app.services.nessus_integration_service - INFO - Processed 51 vulnerabilities for host 10.12.16.5
2025-09-24 20:29:21,875 - app.services.nessus_integration_service - INFO - Processed 15 vulnerabilities for host 10.12.16.1
2025-09-24 20:29:21,881 - app.services.ingestion_service - ERROR - Failed ingestion job 2
Traceback (most recent call last):
  File "/app/app/services/ingestion_service.py", line 270, in _process_job
    job.id,
    ^^^^^^
  File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 569, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1096, in get
    value = self._fire_loader_callables(state, key, passive)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1126, in _fire_loader_callables
    return state._load_expired(state, passive)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 803, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
  File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 1607, in load_scalar_attributes
    raise orm_exc.DetachedInstanceError(
sqlalchemy.orm.exc.DetachedInstanceError: Instance <IngestionJob at 0x7f0066544490> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/services/ingestion_service.py", line 192, in _run_job
    result = self._process_job(db, job)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/app/services/ingestion_service.py", line 280, in _process_job
    job.id,
    ^^^^^^
  File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 569, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1096, in get
    value = self._fire_loader_callables(state, key, passive)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py", line 1126, in _fire_loader_callables
    return state._load_expired(state, passive)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/state.py", line 803, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
  File "/opt/venv/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 1607, in load_scalar_attributes
    raise orm_exc.DetachedInstanceError(
sqlalchemy.orm.exc.DetachedInstanceError: Instance <IngestionJob at 0x7f0066544490> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)

=== ERROR PATTERN ANALYSIS ===
Recent errors in backend logs:
backend-1  | Unable to add parse_error_id column to ingestion_jobs: (psycopg2.errors.UndefinedTable) relation "ingestion_jobs" does not exist
backend-1  | [SQL: ALTER TABLE ingestion_jobs ADD COLUMN IF NOT EXISTS parse_error_id INTEGER]
backend-1  | (Background on this error at: https://sqlalche.me/e/20/f405)
backend-1  | 2025-09-24 20:21:05,006 - app.services.ingestion_service - ERROR - Failed ingestion job 1
backend-1  | Traceback (most recent call last):
backend-1  |     raise orm_exc.DetachedInstanceError(
backend-1  | sqlalchemy.orm.exc.DetachedInstanceError: Instance <IngestionJob at 0x7f0066bd9a90> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
backend-1  | During handling of the above exception, another exception occurred:
backend-1  | Traceback (most recent call last):
backend-1  |     raise orm_exc.DetachedInstanceError(
backend-1  | sqlalchemy.orm.exc.DetachedInstanceError: Instance <IngestionJob at 0x7f0066bd9a90> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
backend-1  | 2025-09-24 20:29:21,881 - app.services.ingestion_service - ERROR - Failed ingestion job 2
backend-1  | Traceback (most recent call last):
backend-1  |     raise orm_exc.DetachedInstanceError(
backend-1  | sqlalchemy.orm.exc.DetachedInstanceError: Instance <IngestionJob at 0x7f0066544490> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
backend-1  | During handling of the above exception, another exception occurred:
backend-1  | Traceback (most recent call last):
backend-1  |     raise orm_exc.DetachedInstanceError(
backend-1  | sqlalchemy.orm.exc.DetachedInstanceError: Instance <IngestionJob at 0x7f0066544490> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)

Recent CORS-related issues:
backend-1   | 2025-09-24T20:18:16.115370839Z 2025-09-24 20:18:16,115 - app.main - INFO - CORS origins: ['https://8.8.8.8']

Database connection issues:


frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:48 +0000] "GET /api/v1/dashboard/os-stats HTTP/2.0" 200 359 "https://8.8.8.8/dashboard" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:48 +0000] "GET /api/v1/upload/jobs?limit=5 HTTP/2.0" 200 452 "https://8.8.8.8/dashboard" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:49 +0000] "GET /api/v1/dashboard/risk-insights HTTP/2.0" 200 1982 "https://8.8.8.8/dashboard" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:49 +0000] "GET /api/v1/dashboard/stats HTTP/2.0" 200 903 "https://8.8.8.8/dashboard" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:49 +0000] "GET /api/v1/risk/hosts/risk-summary HTTP/2.0" 200 474 "https://8.8.8.8/dashboard" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:49 +0000] "GET /api/v1/risk/hosts/high-risk?limit=10&min_risk_score=70 HTTP/2.0" 200 275 "https://8.8.8.8/dashboard" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:51 +0000] "GET /api/v1/scans/?skip=0&limit=100 HTTP/2.0" 200 767 "https://8.8.8.8/scans" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:52 +0000] "GET /api/v1/hosts/filters/data HTTP/2.0" 200 3696 "https://8.8.8.8/hosts" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:52 +0000] "GET /api/v1/hosts/filters/data HTTP/2.0" 200 3696 "https://8.8.8.8/hosts" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:53 +0000] "GET /api/v1/hosts/? HTTP/2.0" 200 10323 "https://8.8.8.8/hosts" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:54 +0000] "GET /api/v1/hosts/filters/data HTTP/2.0" 200 3700 "https://8.8.8.8/hosts" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:54 +0000] "GET /api/v1/hosts/? HTTP/2.0" 200 10322 "https://8.8.8.8/hosts" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:57 +0000] "GET /api/v1/hosts/33/conflicts HTTP/2.0" 200 2 "https://8.8.8.8/hosts/33" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"
frontend-1  | 8.8.8.8 - - [24/Sep/2025:20:29:57 +0000] "GET /api/v1/hosts/33 HTTP/2.0" 200 1703 "https://8.8.8.8/hosts/33" "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" "-"

